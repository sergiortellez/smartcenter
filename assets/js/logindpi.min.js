function responseGOauth(e){try{const o=parseJWT(e.credential);if("94652977258-lf78996qj8qd6i9fgeg0j6qk1aq2ehp1.apps.googleusercontent.com"!==o.aud)throw new Error("Invalid token audience.");const t=Math.floor(Date.now()/1e3);if(o.exp<t)throw new Error("Token has expired.");const n=o.name,r=o.email,s=r.split("@")[0],a=o.hd;console.log("User organization:",a),console.log("User name:",n);const c=document.getElementById("notLogged"),i=document.getElementById("dpi");o&&isNaN(Number(s))?(c.style.display="none",i.style.display="grid",buildDPI(s)):(c.style.display="block",i.style.display="none")}catch(e){console.error("Error processing OAuth response:",e)}}function parseJWT(e){const o=e.split(".")[1],t=o.replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(n)}function buildDPI(){const e=window.location.search,o=new URLSearchParams(e),t=o.get("id"),n="AKfycbz1cQAo1aWej117ZhvUoDqcE_KQHynaHdueYWBOHE0ft9tHrZzoIckF7pS1snkAlF-wfw",r="https://script.google.com/a/up.edu.mx/macros/s/"+n+"/exec?id="+t;var s=document.getElementById("dpiIframe");s.setAttribute("src",r)}